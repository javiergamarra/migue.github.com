--- 
layout: post
name: groovlets
title: Groovlets
time: 2009-12-16 23:36:00 +01:00
---
<div style="text-align: justify;">Me imagino que la gente dedicada al desarrollo web estará acostumbrada al concepto de <i>servlet,</i> y posiblemente, hayan escrito muchos de ellos.<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Voy a mostraros una forma sencilla de escribir y configurar servlets en el lenguaje Groovy. Esta funcionalidad compilará nuestros archivos <i>.groovy</i> en el bytecode correspondiente, cargará la clase, y la cacheará, hasta que se produzca un cambio en el archivo <i>groovy</i> inicial.<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">El primer paso que vamos a dar es añadir el soporte para los <i>Groovlets</i>, para lo que necesitaremos añadir en el archivo <i>web.xml</i> de la aplicación web el siguiente fragmento de código:<br /><br /></div><div style="text-align: justify;"><span style="font-family: monospace; font-size: 12px; line-height: 10px; white-space: pre-wrap;"></span><br /></div><pre style="background-color: #eeeeee; border: 2px dashed rgb(153, 153, 153); color: black; font-family: Andale Mono,Lucida Console,Monaco,fixed,monospace; font-size: 11px; line-height: 11px; overflow: auto; padding: 1px; width: 90%;"><code><div style="text-align: justify;"><span style="color: #000091; font-size: 13px; line-height: normal;">&lt;servlet&gt;&lt;servlet-name&gt;Groovy&lt;/servlet-name&gt;</span><br /><br /></div><pre class="code-xml"><span style="color: black; font-size: small;"><span style="font-size: 12px; line-height: 10px; white-space: pre-wrap;"><span style="color: #000091; font-size: small;"><span style="font-size: small;"><span style="font-size: 13px; line-height: normal; white-space: pre;">&lt;servlet-class&gt;groovy.servlet.GroovyServlet&lt;/servlet-class&gt;<br />&lt;/servlet&gt;</span></span></span></span></span></pre><pre class="code-xml"><span style="color: black; font-size: small;"><span style="font-size: 12px; line-height: 15px; white-space: pre-wrap;"><span style="color: #000091; font-size: small;"><span style="font-size: small;"><span style="font-size: 13px; line-height: normal; white-space: pre;">&lt;servlet-mapping&gt;<br />&lt;servlet-name&gt;Groovy&lt;/servlet-name&gt;<br />&lt;url-pattern&gt;*.groovy&lt;/url-pattern&gt;<br />&lt;/servlet-mapping&gt;</span></span></span></span></span></pre></code></pre><div style="text-align: justify;">Ahora estamos en disposición de escribir un servlet en el lenguaje Groovy (llamemoslo <i>hello.groovy</i>). Veamos un ejemplo sencillito:<br /></div><br /><pre style="background-color: #eeeeee; border-bottom-color: rgb(153, 153, 153); border-bottom-style: dashed; border-bottom-width: 2px; border-left-color: rgb(153, 153, 153); border-left-style: dashed; border-left-width: 2px; border-right-color: rgb(153, 153, 153); border-right-style: dashed; border-right-width: 2px; border-top-color: rgb(153, 153, 153); border-top-style: dashed; border-top-width: 2px; color: black; font-family: 'Andale Mono', 'Lucida Console', Monaco, fixed, monospace; font-size: 11px; line-height: 11px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: auto; padding-bottom: 1px; padding-left: 1px; padding-right: 1px; padding-top: 1px; width: 100%;"><code><br /><br /><div style="text-align: justify;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span style="color: #000091; font-size: small;"><span style="font-size: 13px; line-height: normal;"><span style="color: #222233; font-family: tahoma, verdana, sans-serif; white-space: normal;"></span></span></span><br /><br /><br /></div><span style="color: #000091; font-size: small;"></span><br /><span style="color: #000091; font-size: small;"></span><br /><span style="color: #000091; font-size: small;"><pre class="code-java"><span style="background-color: inherit; color: #000091;">if</span> (!session) {<br />  session = request.session(<span style="background-color: inherit; color: #000091;">true</span>)<br />}<br /><br /><span style="background-color: inherit; color: #000091;">if</span> (!session.counter) {<br />      session.counter = 1<br />}<br /><br />html.html {    <span style="background-color: inherit; color: grey;">// utilizamos del MarkupBuilder&nbsp;</span></pre><pre class="code-java"><span style="background-color: inherit; color: grey;">               // para construir una página tonta de respuesta<br /></span>  head {<br />      title(<span style="background-color: inherit; color: #009100;">"Esto es un Groovy Servlet"</span>)<br />  }<br />  body {<br />    p(<span style="background-color: inherit; color: #009100;">"Bienvenido, ${request.remoteHost}: ${session.counter}! ${<span style="background-color: inherit; color: #000091;">new</span> Date()}"</span>)<br />  }<br />}</pre><pre class="code-java"><span style="font-family: tahoma, verdana, sans-serif; white-space: normal;"><br /><br /><pre class="code-java" style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span style="background-color: inherit; color: grey;">// incrementamos el contador en la session</span></pre></span>session.counter = session.counter + 1</pre></span></div></code></pre><br /><div>En el <i>servlet </i>(<i>groovlet</i>) anterior existen una serie de variables implícitas tales como, request, response, context, application, session, params, headers, out, sout y html.<br /><br />Un paso adicional de configuración, sumamente importante, para poner nuestro <i>groovlet</i> en marcha, consiste en incluir las dependencias necesarias. La opción más sencilla es incluir el archivo <i>groovy-all-XXX.jar</i> en el directorio <i>WEB-INF/lib</i> de la aplicación web.<br /><br />Si, por ejemplo, colocamos los archivos <i>.groovy</i> en el raiz de nuestra aplicación el servlet de <i>groovy</i> se encargará de compilar los archivos. En el caso de tomcat podríamos editar el archivo<span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;"><i>&nbsp;</i><i>tomcat/conf/server.xml</i> del siguiente modo:</span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;"><br /></span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;"><span style="font-size: 13px; line-height: normal;"></span></span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><pre class="code-xml"><span style="background-color: inherit; color: #000091;">&lt;Context path=<span style="background-color: inherit; color: #009100;">"/groovy"</span> docBase=<span style="background-color: inherit; color: #009100;">"c:/groovy-servlet-base"</span>/&gt;</span></pre><pre class="code-xml"><span style="color: #000091;"><br /></span></pre><pre class="code-xml"><span style="color: #000091;"><br /></span></pre></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;">Podríamos acceder al archivo creado anteriormente mediante la siguiente ur:l&nbsp;<a class="external-link" href="http://localhost:8080/groovy/hello.groovy" style="color: #2266cc; text-decoration: none;"><b>http://localhost:8080/groovy/hello.groovy</b></a></span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;"><br /></span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;">Hasta pronto,</span></span><br /><span style="color: #222233; font-family: tahoma, verdana, sans-serif; font-size: small;"><span style="font-size: 12px; line-height: 18px;">Migue</span></span><br /></div><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/35092134-7667659192971921171?l=miguelinlas3.blogspot.com' alt='' /></div>
